"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[661],{9392:function(e,n,t){t.d(n,{Kk:function(){return Z},MO:function(){return C},ZP:function(){return k},c4:function(){return w}});var r,i,o,s=t(50029),a=t(71383),c=t(87794),l=t.n(c),u=t(11163),d=t(85444),p=t(99603),f=t(59417),h=t(63537),x=t(89704),m=t(64575),v=t(34798),g=t.n(v),b=t(50334),j=t(85893),w=d.default.div(r||(r=(0,a.Z)(["\n  height: 100%;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  padding-right: 15px;\n  & > * {\n    margin-left: 15px;\n  }\n"]))),Z=(0,d.default)(p.G)(i||(i=(0,a.Z)(["\n  cursor: ",";\n  ","\n  ",";\n"])),(function(e){return e.disabled?"not-allowed":"pointer"}),(function(e){return e.disabled?"color: #CACACA;":"color: inherit; &:hover { color: ".concat(e.activeColor||"#000","; }")}),(function(e){return e.isUnread?"color: ".concat(m.Uo):""})),C=d.default.div(o||(o=(0,a.Z)(["\n  height: 40px;\n  border-right: 2px solid #e3e3e3;\n"])));function k(e){var n=e.request,t=e.onDelete,r=e.defaultActiveColor,i=e.children,o=e.editIconStyle,a=void 0===o?{}:o,c=e.delIconStyle,d=void 0===c?{}:c,p=(0,u.useRouter)(),v=((n||{}).archived,(0,b.$8)(n)),C=(0,b.uP)(n),k="delete-modal-".concat(null===n||void 0===n?void 0:n.id),y=function(){var e=(0,s.Z)(l().mark((function e(t){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.stopPropagation(),C){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,p.push("/request/".concat(n.id,"?status=").concat(n.status));case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),P=function(){var e=(0,s.Z)(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!["pr","planned","submitted"].includes((null===n||void 0===n?void 0:n.status)||"")){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,(0,x.Jl)(n.id);case 5:window.location.hash="#",t&&t(n);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)(w,{children:[i,(0,j.jsx)(Z,{disabled:!C,icon:f.Xcf,role:"button","aria-label":"edit",onClick:y,activeColor:r,title:"Edit",size:"lg",style:a}),(0,j.jsx)(Z,{icon:f.$aW,role:"button","aria-label":"delete",onClick:v?function(){n.id&&v&&(window.location.hash=k)}:g(),disabled:!v,activeColor:m.Uo,title:"Delete",size:"lg",style:d})]}),(0,j.jsx)(h.Z,{id:k,content:"You are about to delete this integration request. This action cannot be undone.",onConfirm:P,title:"Confirm Deletion",confirmText:"Delete"})]})}},28471:function(e,n,t){t.d(n,{$:function(){return f},B:function(){return h}});var r,i,o=t(71383),s=(t(67294),t(85444)),a=t(99603),c=t(59417),l=t(64575),u=t(85893),d=(0,s.default)(a.G)(r||(r=(0,o.Z)(["\n  margin-right: 10px;\n"]))),p=s.default.div(i||(i=(0,o.Z)(["\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n"])));function f(e){var n=e.children;return(0,u.jsxs)(p,{children:[(0,u.jsx)(d,{icon:c.sqG,color:l.UH,size:"2x"}),(0,u.jsx)("span",{children:(0,u.jsx)("em",{children:n})})]})}function h(e){var n=e.children;return(0,u.jsxs)(p,{children:[(0,u.jsx)(d,{icon:c.eHv,color:l.Uo,size:"2x"}),(0,u.jsx)("span",{children:(0,u.jsx)("em",{children:n})})]})}},44832:function(e,n,t){var r,i=t(71383),o=t(85444);n.Z=o.default.ul(r||(r=(0,i.Z)(["\n  list-style-type: none;\n  margin: 0;\n  position: relative;\n\n  & li {\n    border-bottom: 1px solid #d4d4d4;\n    & svg.svg-inline--fa {\n      position: absolute;\n      right: 0;\n    }\n\n    & div.icon {\n      position: absolute;\n      right: 0;\n      bottom: 5px;\n    }\n  }\n"])))},91832:function(e,n,t){t.d(n,{s:function(){return O},Z:function(){return Y}});var r,i,o,s,a,c,l=t(16835),u=t(50029),d=t(71383),p=t(87794),f=t.n(p),h=t(67294),x=t(42050),m=t(85444),v=t(64575),g=m.default.h3(r||(r=(0,d.Z)(["\n  color: #777777;\n  font-size: ",";\n  font-weight: bold;\n  min-height: 30px;\n  border-bottom: 1px solid #707070;\n  margin-bottom: 5px;\n  overflow: wrap;\n"])),v.CA),b=t(99603),j=t(59417),w=t(74150),Z=t(85330),C=m.default.p(i||(i=(0,d.Z)(["\n  font-size: ",";\n  color: "," !important;\n"])),v.KN,v.we),k=t(11752),y=t.n(k),P=t(44832),F=t(28471),T=t(7541),B=t(89704),G=t(85893),q=(y()()||{}).publicRuntimeConfig,R=(void 0===q?{}:q).app_env,A=(0,m.default)(g)(o||(o=(0,d.Z)(["\n  border-bottom: none;\n  margin-top: 10px;\n"]))),S=(0,m.default)(A)(s||(s=(0,d.Z)(["\n  font-size: 14px;\n"]))),z=m.default.a(a||(a=(0,d.Z)(["\n  color: ",";\n"])),v.nc),L=(0,m.default)(x.Z)(c||(c=(0,d.Z)(["\n  margin-bottom: 10px;\n"]))),U=function(e){switch(e){case"submitted":return 0;case"pr":return 33;case"planned":return 66;default:return 100}},D=function(e){switch(e){case"prFailed":case"planFailed":case"applyFailed":return!0;default:return!1}};function O(e){var n=e.integration,t=n.status,r=n.updatedAt,i=D(t),o=new Date(r||"").toLocaleString();return(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)(L,{now:U(t),animated:!0,variant:i?"danger":void 0}),(0,G.jsxs)(C,{children:["Last updated at ",o]})]})}var Y=(0,T.hU)((function(e){var n=e.integration,t=e.title,r=e.alert,i=n.id,o=n.status,s=n.updatedAt,a=n.prNumber,c=(0,h.useState)(!1),d=c[0],p=c[1],x=D(o),m=function(e){switch(e){case"submitted":return"Process request submitted...";case"pr":return"Pull request created...";case"planned":return"Terraform plan succeeded...";case"prFailed":case"planFailed":case"applyFailed":return"An error has occurred";default:return""}}(o),v=new Date(s||"");(0,h.useEffect)((function(){var e=6e4*20<(new Date).getTime()-v.getTime();p(e)}),[n]);var g=[(0,G.jsxs)("li",{children:["Process request submitted",(0,G.jsx)(b.G,{icon:j.f8k,color:"#00C45B"})]},"1")],C=function(e){switch(e){case"submitted":default:return 0;case"pr":return 1;case"prFailed":return 2;case"planned":return 3;case"planFailed":return 4;case"applied":return 5;case"applyFailed":return 6}}(o);if(C<1)g.push((0,G.jsxs)("li",{children:["Pull request created",(0,G.jsx)(b.G,{icon:j.LM3,color:"#B2B2B2",spin:!0})]},"2"));else if(2===C)g.push((0,G.jsxs)("li",{children:["Pull request creation failed",(0,G.jsx)(b.G,{icon:j.nYk,color:"#FF0000"})]},"2"));else{var k="production"===R?"https://github.com/bcgov/sso-terraform/pull/".concat(a):"https://github.com/bcgov/sso-terraform-dev/pull/".concat(a);g.push((0,G.jsxs)("li",{children:["Pull request created (",(0,G.jsx)(w.default,{external:!0,href:k,children:"link"}),")",(0,G.jsx)(b.G,{icon:j.f8k,color:"#00C45B"})]},"2"))}C<3?g.push((0,G.jsxs)("li",{children:["Terraform plan succeeded",(0,G.jsx)(b.G,{icon:j.LM3,color:"#B2B2B2",spin:!0})]},"3")):4===C?g.push((0,G.jsxs)("li",{children:["Terraform plan failed",(0,G.jsx)(b.G,{icon:j.nYk,color:"#FF0000"})]},"3")):g.push((0,G.jsxs)("li",{children:["Terraform plan succeeded",(0,G.jsx)(b.G,{icon:j.f8k,color:"#00C45B"})]},"3")),C<5?g.push((0,G.jsxs)("li",{children:["Request processed",(0,G.jsx)(b.G,{icon:j.LM3,color:"#B2B2B2",spin:!0})]},"4")):6===C?g.push((0,G.jsxs)("li",{children:["Request failed",(0,G.jsx)(b.G,{icon:j.nYk,color:"#FF0000"})]},"4")):g.push((0,G.jsxs)("li",{children:["Request processed",(0,G.jsx)(b.G,{icon:j.f8k,color:"#00C45B"})]},"4")),console.log("isWaitingTooLongisWaitingTooLong",d);var y=null;return x?y=(0,G.jsxs)(F.B,{children:["You have an unexpected error. Please contact our SSO support team by"," ",(0,G.jsx)(z,{href:"https://chat.developer.gov.bc.ca/channel/sso",target:"_blank",title:"Rocket Chat",children:"Rocket.Chat"})," ","or"," ",(0,G.jsx)(z,{href:"mailto:bcgov.sso@gov.bc.ca",title:"Pathfinder SSO",target:"blank",children:"Email us"})," "]}):d&&(y=(0,G.jsxs)(F.$,{children:[(0,G.jsx)("div",{children:"Your integration submission is taking longer than expected, please select resubmit."}),(0,G.jsx)(Z.zx,{variant:"bcPrimary",size:"small",type:"button",onClick:(0,u.Z)(f().mark((function e(){var n,t,o,s,a;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,B.ct)(i);case 2:n=e.sent,t=(0,l.Z)(n,2),t[0],o=t[1],s=o?"danger":"success",a=o?"failed to resubmit the request":"resubmitted the request successfully",r.show({variant:s,fadeOut:1e4,closable:!0,content:a}),p(!1);case 10:case"end":return e.stop()}}),e)}))),children:"Resubmit"})]})),(0,G.jsxs)(G.Fragment,{children:[t&&(0,G.jsx)(A,{children:t}),(0,G.jsx)(S,{children:m}),(0,G.jsx)(O,{integration:n}),(0,G.jsx)(P.Z,{children:g}),y]})}))},50334:function(e,n,t){t.d(n,{$8:function(){return r},VV:function(){return s},Yr:function(){return a},te:function(){return o},uP:function(){return i}});var r=function(e){return!(!e||e.apiServiceAccount||e.archived||["pr","planned","submitted"].includes((null===e||void 0===e?void 0:e.status)||""))&&(!e.usesTeam||"admin"===e.userTeamRole)},i=function(e){return!(!e||e.apiServiceAccount||e.archived||!["draft","applied"].includes(e.status||""))},o=function(e){return!(!e||Number(e.integrationCount)>0)&&"admin"===e.role},s=function(e){return!!e&&"admin"===e.role},a=function(e){return!(!e||e.apiServiceAccount||e.archived||["pr","planned","submitted"].includes((null===e||void 0===e?void 0:e.status)||""))&&(!e.usesTeam||"admin"===e.userTeamRole)}},77506:function(e,n,t){t.d(n,{F:function(){return h}});var r,i,o=t(71383),s=t(67294),a=t(11163),c=t(64735),l=t(85444),u=t(85330),d=t(17933),p=t(77945),f=t(85893),h=[{maxWidth:900,marginTop:0,marginLeft:10,marginRight:10,marginUnit:"px",horizontalAlign:"none"},{width:480,marginTop:0,marginLeft:2.5,marginRight:2.5,marginUnit:"rem",horizontalAlign:"none"}],x=l.default.div(r||(r=(0,o.Z)(["\n  overflow: auto;\n"]))),m=l.default.div(i||(i=(0,o.Z)(["\n  padding-top: 2px;\n"])));n.Z=function(e){var n,t=e.tab,r=e.leftPanel,i=e.rightPanel,o=e.children,l=(0,a.useRouter)(),v=(0,s.useContext)(p.SessionContext)||{},g=v.user,b=v.enableGold,j=null===g||void 0===g||null===(n=g.integrations)||void 0===n?void 0:n.find((function(e){return"silver"===e.serviceType})),w=(0,f.jsxs)(u.mQ,{onChange:function(e){l.replace("/my-dashboard/".concat(e))},activeKey:t,tabBarGutter:30,children:[(0,f.jsx)(u.OK,{tab:"My Projects"},"integrations"),(0,f.jsx)(u.OK,{tab:"My Teams"},"teams"),b&&j&&(0,f.jsx)(u.OK,{tab:"*New - Silver to Gold Upgrade"},"s2g")]});return(0,f.jsx)(d.Z,{rules:h,children:o?(0,f.jsxs)(m,{children:[w,o]}):(0,f.jsx)(c.ZP,{cols:10,children:(0,f.jsxs)(c.ZP.Row,{collapse:"1100",gutter:[15,2],children:[(0,f.jsx)(c.ZP.Col,{span:6,children:(0,f.jsxs)(x,{children:[w,r&&r()]})}),(0,f.jsx)(c.ZP.Col,{span:4,children:i&&i()})]})})})}}}]);