(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[304],{93626:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return M}});var r,a,s,o,c,i,u,l=n(50029),p=n(59499),d=n(71383),f=n(87794),h=n.n(f),x=n(67294),b=n(99603),v=n(59417),m=n(85330),g=n(59912),j=n(42894),w=n(21963),y=n(84105),k=n(73923),_=new Date,C="".concat(_.getFullYear()).concat(_.getMonth()+1).concat(_.getDate()).concat(_.getHours()).concat(_.getMinutes()),O=(r=(0,l.Z)(h().mark(function e(){var t,n,r;return h().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,w.e.get("reports/all-standard-integrations").then(function(e){return e.data});case 3:t=e.sent,n=y.P6.json_to_sheet(t),r=y.P6.book_new(),y.P6.book_append_sheet(r,n,"All standard integrations"),y.NC(r,"all-standard-integrations-".concat(C,".xlsx")),e.next=14;break;case 10:return e.prev=10,e.t0=e.catch(0),console.log(e.t0),e.abrupt("return",(0,w.z)(e.t0));case 14:case"end":return e.stop()}},e,null,[[0,10]])})),function(){return r.apply(this,arguments)}),P=(a=(0,l.Z)(h().mark(function e(t,n){var r,a,s;return h().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,w.e.get("reports/database-tables",{params:{type:t,orderBy:n}}).then(function(e){return e.data});case 3:r=e.sent,a=y.P6.json_to_sheet(r),s=y.P6.book_new(),y.P6.book_append_sheet(s,a,"All ".concat(t)),y.NC(s,"all-".concat(t.toLowerCase(),"-").concat(C,".xlsx")),e.next=14;break;case 10:return e.prev=10,e.t0=e.catch(0),console.log(e.t0),e.abrupt("return",(0,w.z)(e.t0));case 14:case"end":return e.stop()}},e,null,[[0,10]])})),function(e,t){return a.apply(this,arguments)}),Z=(s=(0,l.Z)(h().mark(function e(){var t,n,r;return h().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,w.e.get("reports/all-bceid-approved-requests-and-events").then(function(e){return e.data});case 3:t=e.sent,n=y.P6.json_to_sheet(t),r=y.P6.book_new(),y.P6.book_append_sheet(r,n,"All BCeID Approved Reqs&Events"),y.NC(r,"all-bceid-approved-requests-and-events-".concat(C,".xlsx")),e.next=14;break;case 10:return e.prev=10,e.t0=e.catch(0),console.log(e.t0),e.abrupt("return",(0,w.z)(e.t0));case 14:case"end":return e.stop()}},e,null,[[0,10]])})),function(){return s.apply(this,arguments)}),E=(o=(0,l.Z)(h().mark(function e(){var t;return h().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,w.e.get("reports/data-integrity").then(function(e){return e.data});case 3:t=e.sent,(0,k.Di)((0,k.ON)(t),"sso-css-data-integrity-".concat(new Date().getTime(),".json")),e.next=11;break;case 7:return e.prev=7,e.t0=e.catch(0),console.log(e.t0),e.abrupt("return",(0,w.z)(e.t0));case 11:case"end":return e.stop()}},e,null,[[0,7]])})),function(){return o.apply(this,arguments)}),D=n(71893),N=n(74379),q=n(76691),A=n(85893);function z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function R(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?z(Object(n),!0).forEach(function(t){(0,p.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):z(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var T=D.ZP.div(c||(c=(0,d.Z)(["\n  border-bottom: 1px solid #707070;\n  margin-bottom: 20px;\n  padding-bottom: 10px;\n"]))),S=D.ZP.div(i||(i=(0,d.Z)(["\n  display: flex;\n"]))),U=D.ZP.div(u||(u=(0,d.Z)(["\n  padding-top: 5px;\n  margin-left: 20px;\n"]))),I=[{maxWidth:900,marginTop:0,marginLeft:10,marginRight:10,marginUnit:"px",horizontalAlign:"none"},{width:480,marginTop:0,marginLeft:2.5,marginRight:2.5,marginUnit:"rem",horizontalAlign:"none"}],L=[{value:"all-requests",label:"Integrations"},{value:"all-users",label:"Users"},{value:"all-teams",label:"Teams"},{value:"all-events",label:"Events"}],B={"all-requests":"Requests","all-users":"Users","all-teams":"Teams","all-events":"Events"},F={Requests:"id",Users:"id",Teams:"id",Events:"request_id"};function G(e){return""==e.type?(0,A.jsx)(A.Fragment,{}):(0,A.jsx)(q.Kk,{icon:v.q7m,role:"button",onClick:e.handleClick,title:"Download",size:"lg"})}function M(e){e.session;var t,n,r,a,s=(0,x.useState)(!1),o=s[0],c=s[1],i=(0,x.useState)(""),u=i[0],p=i[1],d=(t=(0,l.Z)(h().mark(function e(){return h().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return c(!0),e.next=3,O();case 3:c(!1);case 4:case"end":return e.stop()}},e)})),function(){return t.apply(this,arguments)}),f=(n=(0,l.Z)(h().mark(function e(){return h().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return c(!0),e.next=3,Z();case 3:c(!1);case 4:case"end":return e.stop()}},e)})),function(){return n.apply(this,arguments)}),w=(r=(0,l.Z)(h().mark(function e(){return h().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return c(!0),e.next=3,E();case 3:c(!1);case 4:case"end":return e.stop()}},e)})),function(){return r.apply(this,arguments)}),y=(a=(0,l.Z)(h().mark(function e(){return h().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return c(!0),e.next=3,P(B[u],F[B[u]]);case 3:c(!1);case 4:case"end":return e.stop()}},e)})),function(){return a.apply(this,arguments)});return(0,A.jsxs)(g.Z,{rules:I,children:[(0,A.jsx)("h2",{children:"Reports"}),(0,A.jsx)(T,{children:o?(0,A.jsx)(j.rj,{color:"#000",height:25,width:25,wrapperClass:"d-block",visible:o}):(0,A.jsxs)(A.Fragment,{children:[(0,A.jsxs)(m.zx,{variant:"primary",type:"button",className:"text-center",onClick:d,children:[(0,A.jsx)("span",{children:"All Standard Integrations\xa0"}),(0,A.jsx)(b.G,{icon:v.q7m})]}),(0,A.jsx)("br",{}),(0,A.jsx)("br",{}),(0,A.jsxs)(m.zx,{variant:"primary",type:"button",className:"text-center",onClick:f,children:[(0,A.jsx)("span",{children:"All BCeID Approved Requests And Events\xa0"}),(0,A.jsx)(b.G,{icon:v.q7m})]}),(0,A.jsx)("br",{}),(0,A.jsx)("br",{}),(0,A.jsxs)(m.zx,{variant:"primary",type:"button",className:"text-center",onClick:w,children:[(0,A.jsx)("span",{children:"Data Integrity\xa0"}),(0,A.jsx)(b.G,{icon:v.q7m})]})]})}),(0,A.jsx)("h2",{children:"Database"}),o?(0,A.jsx)(j.rj,{color:"#000",height:25,width:25,wrapperClass:"d-block",visible:o}):(0,A.jsxs)(S,{children:[(0,A.jsx)(function(){return(0,A.jsx)(N.ZP,{value:L.filter(function(e){return e.value===u}),options:L,onChange:function(e){return p(e.value)},maxMenuHeight:300,placeholder:"Select table...",styles:{control:function(e){return R(R({},e),{},{width:"250px"})},menu:function(e){return R(R({},e),{},{width:"250px"})}}})},{}),(0,A.jsx)(U,{children:(0,A.jsx)(G,{type:u,handleClick:y})})]})]})}},73923:function(e,t,n){"use strict";n.d(t,{Di:function(){return s},ON:function(){return r},TE:function(){return a}});var r=function(e){return JSON.stringify(e,void 0,2)},a=function(e){var t=document.createElement("textarea");t.value=e,document.body.appendChild(t),t.focus(),t.select();try{return document.execCommand("copy"),document.body.removeChild(t),!0}catch(e){return document.body.removeChild(t),!1}},s=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"application/json",r=window.URL.createObjectURL(new Blob([e],{type:n})),a=document.createElement("a");a.href=r,a.setAttribute("download",t),document.body.appendChild(a),a.click(),document.body.removeChild(a)}},36484:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin-reports",function(){return n(93626)}])},20067:function(){},72061:function(){}},function(e){e.O(0,[251,693,634,691,774,888,179],function(){return e(e.s=36484)}),_N_E=e.O()}]);