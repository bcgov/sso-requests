(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[897],{19344:function(e,t,n){"use strict";var r,i,a,s=n(71383),l=n(85444),o=n(77740),u=n(63005),c=n(85893),d=l.default.table(r||(r=(0,s.Z)(["\n  font-size: unset;\n  & tr {\n    display: flex;\n    margin-bottom: 5px;\n    & > td {\n      border: none;\n      padding: 0 5px 0 0;\n    }\n  }\n"]))),p=l.default.span(i||(i=(0,s.Z)(["\n  font-weight: 600;\n"]))),v=l.default.ul(a||(a=(0,s.Z)(["\n  list-style: none;\n  margin: 0;\n  & li {\n    margin: 0;\n  }\n"]))),f=function(e){var t=e.list,n=e.title,r=e.inline,i=void 0!==r&&r;return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("tr",{children:[(0,c.jsx)("td",{children:n}),((null==t?void 0:t.length)===1||i)&&(0,c.jsx)(p,{children:null==t?void 0:t.map(function(e,n){return(0,c.jsxs)("span",{children:[e,n!==t.length-1&&", "," "]},e)})})]}),!i&&((null==t?void 0:t.length)||0)>1&&(0,c.jsx)("tr",{children:(0,c.jsx)("td",{children:(0,c.jsx)(p,{children:(0,c.jsx)(v,{children:null==t?void 0:t.map(function(e){return(0,c.jsx)("li",{children:e},e)})})})})})]})};t.Z=function(e){var t,n,r,i,a,s=e.children,l=e.request,v=e.teams;if(!l)return null;var h="gold"==("gold"===l.serviceType?"gold":"silver")?l.devIdps:u.GO[l.realm||"onestopauth"],b="saml"!==l.protocol,x="";return l.usesTeam&&(x=(null===(a=(void 0===v?[]:v).find(function(e){return String(e.id)===String(l.teamId)}))||void 0===a?void 0:a.name)||l.team&&l.team.name),(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(d,{children:(0,c.jsxs)("tbody",{children:[x?(0,c.jsxs)("tr",{children:[(0,c.jsx)("td",{children:"Associated Team:"}),(0,c.jsx)("td",{children:(0,c.jsx)(p,{children:x})})]}):(0,c.jsxs)("tr",{children:[(0,c.jsx)("td",{children:"Are you accountable for this project?"}),(0,c.jsx)("td",{children:(0,c.jsx)(p,{children:void 0===(t=l.projectLead)?"":t?"Yes":"No"})})]}),(0,c.jsxs)("tr",{children:[(0,c.jsx)("td",{children:"Client Protocol:"}),(0,c.jsx)("td",{children:(0,c.jsx)(p,{children:b?"OpenID Connect":"SAML"})})]}),b&&(0,c.jsxs)("tr",{children:[(0,c.jsx)("td",{children:"Client Type:"}),(0,c.jsx)("td",{children:(0,c.jsx)(p,{children:l.publicAccess?"Public":"Confidential"})})]}),(0,c.jsxs)("tr",{children:[(0,c.jsx)("td",{children:"Usecase:"}),(0,c.jsx)("td",{children:(0,c.jsx)(p,{children:o.F[l.authType||"browser-login"]})})]}),(0,c.jsxs)("tr",{children:[(0,c.jsx)("td",{children:"Project Name:"}),(0,c.jsx)("td",{children:(0,c.jsx)(p,{children:l.projectName})})]}),l.additionalRoleAttribute&&(0,c.jsxs)("tr",{children:[(0,c.jsx)("td",{children:"Additional Role Attribute:"}),(0,c.jsx)("td",{children:(0,c.jsx)(p,{children:l.additionalRoleAttribute})})]}),(0,c.jsx)(f,{list:h,title:"Identity Providers Required:",inline:!0}),(null===(n=l.environments)||void 0===n?void 0:n.includes("dev"))&&(0,c.jsx)(f,{list:l.devValidRedirectUris,title:"Dev Redirect URIs:"}),(null===(r=l.environments)||void 0===r?void 0:r.includes("test"))&&(0,c.jsx)(f,{list:l.testValidRedirectUris,title:"Test Redirect URIs:"}),(null===(i=l.environments)||void 0===i?void 0:i.includes("prod"))&&(0,c.jsx)(f,{list:l.prodValidRedirectUris,title:"Prod Redirect URIs:"}),s]})})})}},66400:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return ed}});var r,i,a,s,l,o=n(16835),u=n(50029),c=n(87794),d=n.n(c),p=n(67294),v=n(11163),f=n(20070),h=n.n(f),b=n(59417),x=n(53442),j=n(37226),m=n(76691),g=n(61165),S=n(63055),w=n(31513),y=n(71383),E=n(85444),P=n(85330),A=n(99154),C=n(19344),R=n(4826),U=n(88916),O=[{value:"draft",label:"Draft"},{value:"submitted",label:"Submitted"},{value:"pr",label:"PR"},{value:"prFailed",label:"PR Failed"},{value:"planned",label:"Planned"},{value:"applied",label:"Applied"},{value:"applyFailed",label:"Apply Failed"}],T=n(85893),_=function(e){var t,n=e.request,r=e.onUpdate,i=(0,p.useState)(n.status),a=i[0],s=i[1],l="edit-metadata",o=(t=(0,u.Z)(d().mark(function e(){return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,j.Uw)({id:n.id,status:a});case 2:if(!r){e.next=5;break}return e.next=5,r();case 5:window.location.hash="#";case 6:case"end":return e.stop()}},e)})),function(){return t.apply(this,arguments)});(0,p.useEffect)(function(){s(n.status)},[n.id]);var c=(0,T.jsxs)("div",{"data-testid":"integration-status",children:[(0,T.jsx)("p",{style:{fontWeight:"bold"},children:"Integration Status"}),(0,T.jsx)(U.ZP,{className:"react-select-container",classNamePrefix:"select",options:O,onChange:function(e){return s(e.value)},isSearchable:!0})]});return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(R.default,{variant:"bcPrimary",size:"small",onClick:function(){return window.location.hash=l},children:"Edit Metadata"}),(0,T.jsx)(g.Z,{id:l,content:c,onConfirm:o,icon:b.UJf,title:"Edit Metadata",closable:!0})]})},Z=E.default.div(r||(r=(0,y.Z)(["\n  max-height: calc(100vh - 250px);\n  overflow: auto;\n"])));function k(e){var t=e.currentUser,n=e.request,r=e.onUpdate;return n?(0,T.jsxs)(Z,{children:[(0,T.jsx)("br",{}),(0,T.jsxs)(C.Z,{request:n,children:[(0,T.jsx)("br",{}),t.isAdmin&&(0,T.jsx)(_,{request:n,onUpdate:r})]})]}):null}var I=n(59499),D=n(56839),q=n(70300),F=n(76944),N=n(83333);function L(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function K(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?L(Object(n),!0).forEach(function(t){(0,I.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):L(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var Q=E.default.div(i||(i=(0,y.Z)(["\n  text-align: center;\n"]))),H=[{value:"all",label:"All Events"},{value:"request-pr-success",label:"REQUEST_PR_SUCCESS"},{value:"request-pr-failure",label:"REQUEST_PR_FAILURE"},{value:"request-plan-success",label:"REQUEST_PLAN_SUCCESS"},{value:"request-plan-failure",label:"REQUEST_PLAN_FAILURE"},{value:"request-apply-success",label:"REQUEST_APPLY_SUCCESS"},{value:"request-apply-failure",label:"REQUEST_APPLY_FAILURE"},{value:"request-create-success",label:"REQUEST_CREATE_SUCCESS"},{value:"request-create-failure",label:"REQUEST_CREATE_FAILURE"},{value:"request-update-success",label:"REQUEST_UPDATE_SUCCESS"},{value:"request-update-failure",label:"REQUEST_UPDATE_FAILURE"},{value:"request-delete-success",label:"REQUEST_DELETE_SUCCESS"},{value:"request-delete-failure",label:"REQUEST_DELETE_FAILURE"},{value:"email-submission-failure",label:"EMAIL_SUBMISSION_FAILURE"}];function M(e){var t,n=e.requestId,r=(0,p.useState)("all"),i=r[0],a=r[1],s=(0,p.useState)([]),l=s[0],c=s[1],v=(0,p.useState)(!1),f=v[0],h=v[1],b=(0,p.useState)(!1),x=b[0],j=b[1],m=(t=(0,u.Z)(d().mark(function e(){var t,r,a;return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=2;break}return e.abrupt("return");case 2:return h(!0),e.next=5,(0,F.v)({requestId:n,eventCode:i});case 5:t=e.sent,a=(r=(0,o.Z)(t,2))[0],r[1]?j(!0):a&&c(a.rows),h(!1);case 11:case"end":return e.stop()}},e)})),function(){return t.apply(this,arguments)});(0,p.useEffect)(function(){m()},[n,i]);var g=function(e){a(e)};return x?null:(0,T.jsxs)(T.Fragment,{children:[(0,T.jsxs)(q.Z,{"data-testid":"events-dropdown",children:[(0,T.jsx)("br",{}),(0,T.jsx)(U.ZP,{options:H,onChange:function(e){return g(e.value)},maxMenuHeight:300,styles:{control:function(e){return K(K({},e),{},{width:"250px"})},menu:function(e){return K(K({},e),{},{width:"250px"})}}})]}),f?(0,T.jsx)(Q,{children:(0,T.jsx)(D.rj,{color:"#000",height:45,width:45,wrapperClass:"d-block",visible:f})}):(0,T.jsx)(N.Z,{events:l})]})}var B=n(12059);function G(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?G(Object(n),!0).forEach(function(t){(0,I.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):G(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var V=E.default.div(a||(a=(0,y.Z)(["\n  padding-left: 1rem;\n  padding-right: 1rem;\n"]))),W=function(e){var t,n,r=e.integration,i=e.type,a=e.canApproveProd,s=e.awaitingTFComplete,l=e.onApproved;if(!r)return null;var c=h()(i),p="".concat(i,"-approval-modal"),v="bceid"===i?(0,w.he)(r):(0,w.R5)(r);n=a?(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)("p",{children:"To begin the ".concat(c," integration in production, Click Below.")}),(0,T.jsx)(R.default,{onClick:function(){return window.location.hash=p},disabled:s,children:"Approve Prod"})]}):s&&v?(0,T.jsx)(B.Z,{integration:r,title:"The terraform script will take approximately 20 minutes to complete."}):(0,T.jsx)("p",{children:"This integration has already been approved."});var f=(t=(0,u.Z)(d().mark(function e(){var t,n;return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,j.WN)(z(z({},r),{},(0,I.Z)({},"".concat(i,"Approved"),!0)),!0);case 2:t=e.sent,n=(0,o.Z)(t,2)[1],l&&!n&&l();case 6:case"end":return e.stop()}},e)})),function(){return t.apply(this,arguments)});return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsxs)(V,{children:[(0,T.jsx)("br",{}),n]}),(0,T.jsx)(g.Z,{id:p,content:"Are you sure you want to approve this integration for ".concat(c," production?"),onConfirm:f,icon:b.eHv,title:"".concat(c," Approve")})]})},Y=function(e){var t=e.integration,n=e.onApproved;if(!t)return null;var r=t.status,i=t.bceidApproved;return(0,T.jsx)(W,{type:"bceid",integration:t,canApproveProd:!i,awaitingTFComplete:"applied"!==r,onApproved:n})},J=function(e){var t=e.integration,n=e.onApproved;if(!t)return null;var r=t.status,i=t.githubApproved;return(0,T.jsx)(W,{type:"github",integration:t,canApproveProd:!i,awaitingTFComplete:"applied"!==r,onApproved:n})},X=E.default.div(s||(s=(0,y.Z)(["\n  padding-left: 1rem;\n  padding-right: 1rem;\n"]))),$=function(e){var t=e.currentUser,n=e.integration,r=e.defaultTabKey,i=e.setActiveKey,a=e.setRows,s=e.activeKey;if(!n)return null;var l=n.environments,o=(void 0===l?[]:l).includes("prod"),u=(0,A.Jx)(n),c=(0,A.dV)(n);return(0,T.jsx)(T.Fragment,{children:(0,T.jsxs)(P.mQ,{activeKey:void 0===s?r:s,onChange:function(e){return i(e)},tabBarGutter:30,children:[(0,T.jsx)(P.OK,{tab:"Details",children:(0,T.jsx)(X,{children:(0,T.jsx)(k,{currentUser:t,request:n,onUpdate:a})})},"details"),u&&o&&(0,T.jsx)(P.OK,{tab:"BCeID Prod",children:(0,T.jsx)(Y,{integration:n,onApproved:function(){return a()}})},"bceid-prod"),c&&o&&(0,T.jsx)(P.OK,{tab:"GitHub Prod",children:(0,T.jsx)(J,{integration:n,onApproved:function(){return a()}})},"github-prod"),(0,T.jsx)(P.OK,{tab:"Events",children:(0,T.jsx)(X,{children:(0,T.jsx)(M,{requestId:n.id})})},"events")]})})},ee=n(46312),et=n(59912),en=n(49910),er=E.default.div(l||(l=(0,y.Z)(["\n  height: 100%;\n  overflow: auto;\n"]))),ei=function(e){var t=e.leftPanel,n=e.rightPanel,r=e.showResizable;return e.children,(0,T.jsxs)(et.Z,{rules:en.F,children:[void 0===r||r?(0,T.jsx)(ee.e,{style:{paddingTop:"2px",borderBottom:"3px solid black"},defaultSize:{width:"100%",height:.45*window.innerHeight},enable:{bottom:!0},handleStyles:{bottom:{bottom:0}},children:(0,T.jsx)(er,{children:t&&t()})}):t&&t(),(0,T.jsx)("br",{}),n&&n()]})},ea=[{value:"idir",label:"IDIR"},{value:"bceid",label:"BCeID"},{value:"github",label:"GitHub"}],es=[{value:"active",label:"Active"},{value:"archived",label:"Deleted"}],el=[{value:"dev",label:"Dev"},{value:"test",label:"Test"},{value:"prod",label:"Prod"}],eo=[{value:"silver",label:"Silver"},{value:"gold",label:"Gold"}],eu=[5,10,15,30,50,100];function ec(){return(0,T.jsx)("span",{style:{marginLeft:"40%"},children:"Actions"})}function ed(e){var t,n,r,i,a,s,l,c=e.session,f=(0,v.useRouter)(),y=(0,p.useState)(!1),E=y[0],P=y[1],A=(0,p.useState)(!1),C=A[0],R=A[1],U=(0,p.useState)([]),_=U[0],Z=U[1],k=(0,p.useState)(String((null===(s=f.query)||void 0===s?void 0:s.id)||"")),I=k[0],D=k[1],q=(0,p.useState)(0),F=q[0],N=q[1],L=(0,p.useState)(5),K=L[0],Q=L[1],H=(0,p.useState)(1),M=H[0],B=H[1],G=(0,p.useState)(Number(null===(l=f.query)||void 0===l?void 0:l.id)||void 0),z=G[0],V=G[1],W=(0,p.useState)([]),Y=W[0],J=W[1],X=(0,p.useState)([]),ee=X[0],et=X[1],en=(0,p.useState)([]),er=en[0],ed=en[1],ep=(0,p.useState)([]),ev=ep[0],ef=ep[1],eh=(0,p.useState)([]),eb=eh[0],ex=eh[1],ej=(0,p.useState)("details"),em=ej[0],eg=ej[1],eS=_.find(function(e){return e.id===z}),ew=(t=(0,u.Z)(d().mark(function e(){var t,n,r,i,a;return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(0,w.UT)(ee,Y),r=(n=(0,o.Z)(t,3))[0],i=n[1],a=n[2],e.abrupt("return",(0,j.zD)({searchField:["id","projectName"],searchKey:I,order:[["updatedAt","desc"],["status","desc"]],limit:K,page:M,status:er.map(function(e){return e.value}),archiveStatus:ev.map(function(e){return e.value}),realms:i,environments:a,types:eb.map(function(e){return e.value}),devIdps:r}));case 2:case"end":return e.stop()}},e)})),function(){return t.apply(this,arguments)}),ey=(n=(0,u.Z)(d().mark(function e(){var t,n,r;return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return P(!0),e.next=3,ew();case 3:t=e.sent,r=(n=(0,o.Z)(t,2))[0],n[1]?R(!0):r&&(Z(r.rows),N(r.count)),P(!1);case 9:case"end":return e.stop()}},e)})),function(){return n.apply(this,arguments)});if((0,p.useEffect)(function(){V(void 0),ey()},[I,K,M,er,ev,ee,Y,eb]),(0,p.useEffect)(function(){var e;return(0,w.rn)(_)&&(e=setTimeout((0,u.Z)(d().mark(function t(){var n,r,i;return d().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ew();case 2:n=t.sent,i=(r=(0,o.Z)(n,2))[0],r[1]?clearInterval(e):i&&(Z(i.rows),N(i.count));case 7:case"end":return t.stop()}},t)})),5e3)),function(){e&&clearInterval(e)}},[_]),C)return null;var eE=function(e){return["applied"].includes((null==e?void 0:e.status)||"")},eP=function(e){return!["pr","planned","submitted"].includes((null==e?void 0:e.status)||"")},eA=(r=(0,u.Z)(d().mark(function e(t){return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(!t.id||!eE(t))){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,f.push("/request/".concat(t.id,"?status=").concat(t.status));case 4:case"end":return e.stop()}},e)})),function(e){return r.apply(this,arguments)}),eC=(i=(0,u.Z)(d().mark(function e(t){return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(!t.id||!eP(t))){e.next=2;break}return e.abrupt("return");case 2:V(t.id),window.location.hash="delete-modal";case 4:case"end":return e.stop()}},e)})),function(e){return i.apply(this,arguments)}),eR=(a=(0,u.Z)(d().mark(function e(){return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(eP){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,(0,j.Jl)(z);case 4:return e.next=6,ew();case 6:window.location.hash="#";case 7:case"end":return e.stop()}},e)})),function(){return a.apply(this,arguments)}),eU=function(e){V(e.cells[0].value),eg("details")};return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(ei,{leftPanel:function(){return(0,T.jsx)(x.Z,{searchPlaceholder:"Project ID or Name",headers:[{accessor:"id",Header:"Request ID"},{accessor:"projectName",Header:"Project Name"},{accessor:"status",Header:"Request Status"},{accessor:"archived",Header:"File Status"},{accessor:"serviceType",Header:"Service Type"},{accessor:"actions",Header:(0,T.jsx)(ec,{}),disableSortBy:!0}],data:_.map(function(e){return{id:e.id,projectName:e.projectName,status:h()(e.status),archived:e.archived?"Deleted":"Active",serviceType:"gold"===e.serviceType?"Gold":"Silver",environments:e.environments,actions:(0,T.jsxs)(m.c4,{children:[(0,T.jsx)(m.Kk,{icon:b.Mdf,role:"button","aria-label":"events",onClick:function(t){t.stopPropagation(),V(e.id),eg("events")},title:"Events"}),(0,T.jsx)(m.MO,{}),(0,T.jsx)(m.Kk,{disabled:!eE(e),icon:b.Xcf,role:"button","aria-label":"edit",onClick:function(){return eA(e)},title:"Edit"}),(0,T.jsx)(m.MO,{}),(0,T.jsx)(m.Kk,{icon:b.$aW,role:"button","aria-label":"delete",onClick:function(){return eC(e)},disabled:!eP(e),activeColor:S.Uo,title:"Delete"})]})}}),activateRow:eU,colfilters:[{value:Y,multiselect:!0,onChange:J,options:el,label:"Environments"},{value:ee,multiselect:!0,onChange:et,options:ea,label:"IDPs"},{value:er,multiselect:!0,onChange:ed,options:O,label:"Workflow Status"},{value:ev,multiselect:!0,onChange:ef,options:es,label:"Archive Status"},{value:eb,multiselect:!0,onChange:ex,options:eo,label:"Service Type"}],showFilters:!0,loading:E,totalColSpan:15,searchColSpan:5,headerAlign:"bottom",headerGutter:[5,0],onPage:B,rowCount:F,searchKey:I,onSearch:function(e){D(e)},onEnter:function(e){D(e)},pageLimits:eu,limit:K,onLimit:function(e){B(1),Q(e)},noDataFoundElement:(0,T.jsx)("div",{style:{textAlign:"center"},children:"No clients found."}),pagination:!0})},rightPanel:function(){return eS&&(0,T.jsx)($,{currentUser:c,integration:eS,defaultTabKey:"details",setActiveKey:eg,activeKey:em,setRows:ey})}}),(0,T.jsx)(g.Z,{id:"delete-modal",content:"You are about to delete this integration request. This action cannot be undone.",onConfirm:eR,confirmText:"Delete",title:"Confirm Deletion"})]})}},25809:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin-dashboard",function(){return n(66400)}])}},function(e){e.O(0,[428,726,360,926,896,774,888,179],function(){return e(e.s=25809)}),_N_E=e.O()}]);