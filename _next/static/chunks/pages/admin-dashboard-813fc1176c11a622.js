(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[897],{91296:function(e,t,n){var r=0/0,i=/^\s+|\s+$/g,a=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,s=/^0o[0-7]+$/i,l=parseInt,c="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,d="object"==typeof self&&self&&self.Object===Object&&self,u=c||d||Function("return this")(),p=Object.prototype.toString,v=Math.max,f=Math.min,now=function(){return u.Date.now()};function isObject(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function toNumber(e){if("number"==typeof e)return e;if("symbol"==typeof(t=e)||t&&"object"==typeof t&&"[object Symbol]"==p.call(t))return r;if(isObject(e)){var t,n="function"==typeof e.valueOf?e.valueOf():e;e=isObject(n)?n+"":n}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(i,"");var c=o.test(e);return c||s.test(e)?l(e.slice(2),c?2:8):a.test(e)?r:+e}e.exports=function(e,t,n){var r,i,a,o,s,l,c=0,d=!1,u=!1,p=!0;if("function"!=typeof e)throw TypeError("Expected a function");function invokeFunc(t){var n=r,a=i;return r=i=void 0,c=t,o=e.apply(a,n)}function shouldInvoke(e){var n=e-l,r=e-c;return void 0===l||n>=t||n<0||u&&r>=a}function timerExpired(){var e,n,r,i=now();if(shouldInvoke(i))return trailingEdge(i);s=setTimeout(timerExpired,(e=i-l,n=i-c,r=t-e,u?f(r,a-n):r))}function trailingEdge(e){return(s=void 0,p&&r)?invokeFunc(e):(r=i=void 0,o)}function debounced(){var e,n=now(),a=shouldInvoke(n);if(r=arguments,i=this,l=n,a){if(void 0===s)return c=e=l,s=setTimeout(timerExpired,t),d?invokeFunc(e):o;if(u)return s=setTimeout(timerExpired,t),invokeFunc(l)}return void 0===s&&(s=setTimeout(timerExpired,t)),o}return t=toNumber(t)||0,isObject(n)&&(d=!!n.leading,a=(u="maxWait"in n)?v(toNumber(n.maxWait)||0,t):a,p="trailing"in n?!!n.trailing:p),debounced.cancel=function(){void 0!==s&&clearTimeout(s),c=0,r=l=i=s=void 0},debounced.flush=function(){return void 0===s?o:trailingEdge(now())},debounced}},42563:function(e,t,n){"use strict";var r,i,a,o=n(71383),s=n(71893),l=n(11162),c=n(95107),d=n(66496),u=n(85893),p=s.ZP.table(r||(r=(0,o.Z)(["\n  font-size: unset;\n  & tr {\n    display: flex;\n    margin-bottom: 5px;\n    & > td {\n      border: none;\n      padding: 0 5px 0 0;\n    }\n  }\n"]))),v=s.ZP.span(i||(i=(0,o.Z)(["\n  font-weight: 600;\n"]))),f=s.ZP.ul(a||(a=(0,o.Z)(["\n  list-style: none;\n  margin: 0;\n  & li {\n    margin: 0;\n  }\n"]))),FormattedList=function(e){var t=e.list,n=e.title,r=e.inline,i=void 0!==r&&r,a=e.testid;return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)("tr",{children:[(0,u.jsx)("td",{children:n}),((null==t?void 0:t.length)===1||i)&&(0,u.jsx)(v,{"data-testid":a,children:null==t?void 0:t.map(function(e,n){return(0,u.jsxs)("span",{children:[e,n!==t.length-1&&", "," "]},e)})})]}),!i&&((null==t?void 0:t.length)||0)>1&&(0,u.jsx)("tr",{children:(0,u.jsx)("td",{children:(0,u.jsx)(v,{children:(0,u.jsx)(f,{children:null==t?void 0:t.map(function(e){return(0,u.jsx)("li",{children:e},e)})})})})})]})};t.Z=function(e){var t,n,r,i,a,o,s,f,h=e.children,b=e.request,m=e.teams;if(!b)return null;var x=null!==(i=b.devIdps)&&void 0!==i?i:[],j="saml"!==b.protocol,g=x.map(function(e){return c.S[e]}),S=(0,d.e$)(b),y="";b.usesTeam&&(y=(null===(f=(void 0===m?[]:m).find(function(e){return String(e.id)===String(b.teamId)}))||void 0===f?void 0:f.name)||b.team&&b.team.name);var C=(t=b.primaryEndUsers,n=b.primaryEndUsersOther,null==t?void 0:t.map(function(e){switch(e){case"livingInBC":return"People living in BC";case"businessInBC":return"People doing business/travel in BC";case"bcGovEmployees":return"BC Gov Employees";case"other":return"Other: ".concat(null!=n?n:"");default:return""}}));return(0,u.jsx)(u.Fragment,{children:(0,u.jsx)(p,{children:(0,u.jsxs)("tbody",{children:[y?(0,u.jsxs)("tr",{children:[(0,u.jsx)("td",{children:"Associated Team:"}),(0,u.jsx)("td",{children:(0,u.jsx)(v,{"data-testid":"associated-team",children:y})})]}):(0,u.jsxs)("tr",{children:[(0,u.jsx)("td",{children:"Are you accountable for this project?"}),(0,u.jsx)("td",{children:(0,u.jsx)(v,{"data-testid":"you-accountable",children:void 0===(r=b.projectLead)?"":r?"Yes":"No"})})]}),(0,u.jsxs)("tr",{children:[(0,u.jsx)("td",{children:"Client Protocol:"}),(0,u.jsx)("td",{children:(0,u.jsx)(v,{"data-testid":"client-protocol",children:j?"OpenID Connect":"SAML"})})]}),j&&(0,u.jsxs)("tr",{children:[(0,u.jsx)("td",{children:"Client Type:"}),(0,u.jsx)("td",{children:(0,u.jsx)(v,{"data-testid":"client-type-team",children:b.publicAccess?"Public":"Confidential"})})]}),(0,u.jsxs)("tr",{children:[(0,u.jsx)("td",{children:"Usecase:"}),(0,u.jsx)("td",{children:(0,u.jsx)(v,{"data-testid":"use-case",children:l.F[b.authType||"browser-login"]})})]}),(0,u.jsxs)("tr",{children:[(0,u.jsx)("td",{children:"Project Name:"}),(0,u.jsx)("td",{children:(0,u.jsx)(v,{"data-testid":"project-name",children:b.projectName})})]}),C&&(0,u.jsxs)("tr",{children:[(0,u.jsx)("td",{children:"Primary End Users:"}),(0,u.jsx)("td",{children:(0,u.jsx)(v,{"data-testid":"project-name",children:C.join(", ")})})]}),b.additionalRoleAttribute&&(0,u.jsxs)("tr",{children:[(0,u.jsx)("td",{children:"Additional Role Attribute:"}),(0,u.jsx)("td",{children:(0,u.jsx)(v,{"data-testid":"add-role-attrib",children:b.additionalRoleAttribute})})]}),(0,u.jsx)(FormattedList,{list:g,title:"Identity Providers Required:",inline:!0,testid:"idp-required"}),S&&(0,u.jsxs)("tr",{children:[(0,u.jsx)("td",{children:"Privacy Zone:"}),(0,u.jsx)("td",{children:(0,u.jsx)(v,{children:b.bcscPrivacyZone})})]}),(null===(a=b.environments)||void 0===a?void 0:a.includes("dev"))&&(0,u.jsx)(FormattedList,{list:b.devValidRedirectUris,title:"Dev Redirect URIs:",testid:"dev-uri"}),(null===(o=b.environments)||void 0===o?void 0:o.includes("test"))&&(0,u.jsx)(FormattedList,{list:b.testValidRedirectUris,title:"Test Redirect URIs:",testid:"test-uri"}),(null===(s=b.environments)||void 0===s?void 0:s.includes("prod"))&&(0,u.jsx)(FormattedList,{list:b.prodValidRedirectUris,title:"Prod Redirect URIs:",testid:"prod-uri"}),h]})})})}},35477:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return eu}});var r,i,a,o,s,l,c=n(27812),d=n(16835),u=n(50029),p=n(71383),v=n(87794),f=n.n(v),h=n(67294),b=n(11163),m=n(20070),x=n.n(m),j=n(59417),g=n(75913),S=n(88669),y=n(89928),C=n(28084),A=n(32997),w=n(32581),E=n(71893),_=n(85330),P=n(66496),T=n(42563),Z=n(23157),O=[{value:"draft",label:"Draft"},{value:"submitted",label:"Submitted"},{value:"planned",label:"Planned"},{value:"planFailed",label:"Plan Failed"},{value:"applied",label:"Applied"},{value:"applyFailed",label:"Apply Failed"}],k=n(85893),admin_dashboard_MetadataEditModal=function(e){var t,n=e.request,r=e.onUpdate,i=(0,h.useState)(!1),a=i[0],o=i[1],s=(0,h.useState)(n.status),l=s[0],c=s[1],d=(t=(0,u.Z)(f().mark(function _callee(){return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,S.Uw)({id:n.id,status:l});case 2:if(!r){e.next=5;break}return e.next=5,r();case 5:window.location.hash="#";case 6:case"end":return e.stop()}},_callee)})),function(){return t.apply(this,arguments)});(0,h.useEffect)(function(){c(n.status)},[n.id]);var p=(0,k.jsxs)("div",{"data-testid":"integration-status",children:[(0,k.jsx)("p",{style:{fontWeight:"bold"},children:"Integration Status"}),(0,k.jsx)(Z.ZP,{className:"react-select-container",classNamePrefix:"select",options:O.filter(function(e){return["draft","submitted"].includes(e.value)}),onChange:function(e){return c(e.value)},isSearchable:!0})]});return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)("button",{className:"primary",onClick:function(){o(!0)},"data-testid":"edit-metadata-button",children:"Edit Metadata"}),(0,k.jsx)(C.Z,{id:"edit-metadata",openModal:a,handleClose:function(){return o(!1)},content:p,onConfirm:d,icon:j.UJf,title:"Edit Metadata",closable:!0})]})},R=E.ZP.div(r||(r=(0,p.Z)(["\n  max-height: calc(100vh - 250px);\n  overflow: auto;\n"])));function AdminRequestPanel(e){var t=e.currentUser,n=e.request,r=e.onUpdate;return n?(0,k.jsxs)(R,{children:[(0,k.jsx)("br",{}),(0,k.jsxs)(T.Z,{request:n,children:[(0,k.jsx)("br",{}),t.isAdmin&&(0,k.jsx)(admin_dashboard_MetadataEditModal,{request:n,onUpdate:r})]})]}):null}var U=n(59499),I=n(42894),F=n(63980),D=n(2697),N=n(49206);function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach(function(t){(0,U.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var q=E.ZP.div(i||(i=(0,p.Z)(["\n  text-align: center;\n"]))),L=[{value:"all",label:"All Events"},{value:"request-pr-success",label:"REQUEST_PR_SUCCESS"},{value:"request-pr-failure",label:"REQUEST_PR_FAILURE"},{value:"request-plan-success",label:"REQUEST_PLAN_SUCCESS"},{value:"request-plan-failure",label:"REQUEST_PLAN_FAILURE"},{value:"request-apply-success",label:"REQUEST_APPLY_SUCCESS"},{value:"request-apply-failure",label:"REQUEST_APPLY_FAILURE"},{value:"request-create-success",label:"REQUEST_CREATE_SUCCESS"},{value:"request-create-failure",label:"REQUEST_CREATE_FAILURE"},{value:"request-update-success",label:"REQUEST_UPDATE_SUCCESS"},{value:"request-update-failure",label:"REQUEST_UPDATE_FAILURE"},{value:"request-delete-success",label:"REQUEST_DELETE_SUCCESS"},{value:"request-delete-failure",label:"REQUEST_DELETE_FAILURE"},{value:"email-submission-failure",label:"EMAIL_SUBMISSION_FAILURE"}];function AdminEventPanel(e){var t,n=e.requestId,r=(0,h.useState)("all"),i=r[0],a=r[1],o=(0,h.useState)([]),s=o[0],l=o[1],c=(0,h.useState)(!1),p=c[0],v=c[1],b=(0,h.useState)(!1),m=b[0],x=b[1],j=(t=(0,u.Z)(f().mark(function _callee(){var e,t,r;return f().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(n){a.next=2;break}return a.abrupt("return");case 2:return v(!0),a.next=5,(0,D.v)({requestId:n,eventCode:i});case 5:e=a.sent,r=(t=(0,d.Z)(e,2))[0],t[1]?x(!0):r&&l(r.rows),v(!1);case 11:case"end":return a.stop()}},_callee)})),function(){return t.apply(this,arguments)});(0,h.useEffect)(function(){j()},[n,i]);var handleFilterChange=function(e){a(e)};return m?null:(0,k.jsxs)(k.Fragment,{children:[(0,k.jsxs)(F.Z,{"data-testid":"events-dropdown",children:[(0,k.jsx)("br",{}),(0,k.jsx)(Z.ZP,{options:L,onChange:function(e){return handleFilterChange(e.value)},maxMenuHeight:300,styles:{control:function(e){return _objectSpread(_objectSpread({},e),{},{width:"250px"})},menu:function(e){return _objectSpread(_objectSpread({},e),{},{width:"250px"})}}})]}),p?(0,k.jsx)(q,{children:(0,k.jsx)(I.rj,{color:"#000",height:45,width:45,wrapperClass:"d-block",visible:p})}):(0,k.jsx)(N.Z,{events:s})]})}var K=n(49269),M=n(9206);function TabContent_ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function TabContent_objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?TabContent_ownKeys(Object(n),!0).forEach(function(t){(0,U.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):TabContent_ownKeys(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var B=E.ZP.div(a||(a=(0,p.Z)(["\n  padding-left: 1rem;\n  padding-right: 1rem;\n"]))),H={bceid:"bceidApproved",github:"githubApproved",BCServicesCard:"bcServicesCardApproved"},AdminTabs_TabContent=function(e){var t,n,r,i=e.integration,a=e.type,o=e.canApproveProd,s=e.awaitingTFComplete,l=e.onApproved,c=(0,h.useState)(!1),p=c[0],v=c[1],b=(0,h.useState)([]),m=b[0],g=b[1],y=(t=(0,u.Z)(f().mark(function _callee(){var e,t,n,r;return f().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(i){o.next=2;break}return o.abrupt("return");case 2:return o.next=4,(0,D.v)({requestId:Number(i.id),eventCode:"all"});case 4:t=o.sent,(n=(0,d.Z)(t,1)[0])&&(null==n?void 0:null===(e=n.rows)||void 0===e?void 0:e.length)>0&&(r=[],n.rows.forEach(function(e){var t,n;null!=e&&null!==(t=e.details)&&void 0!==t&&null!==(n=t.changes)&&void 0!==n&&n.find(function(e){return null==e?void 0:e.path.includes(H[a])})&&r.push(e)}),r.length>0&&g(r));case 8:case"end":return o.stop()}},_callee)})),function(){return t.apply(this,arguments)});if((0,h.useEffect)(function(){y()},[null==i?void 0:i.id,null==i?void 0:i.bceidApproved,null==i?void 0:i.githubApproved,null==i?void 0:i.bcServicesCardApproved]),!i)return null;var A=x()(a),E=H[a],_=!1;switch(a){case"bceid":_=(0,w.he)(i);break;case"github":_=(0,w.R5)(i);break;case"BCServicesCard":_=(0,w.kF)(i)}r=null!=i&&i.archived?(0,k.jsx)(k.Fragment,{children:(0,k.jsx)("p",{children:"Cannot approve deleted/archived integrations."})}):o?(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)("p",{children:"To begin the ".concat(A," integration in production, Click Below.")}),(0,k.jsx)("button",{className:"primary",onClick:function(){v(!0)},disabled:s,children:"Approve Prod"})]}):s&&_?(0,k.jsx)("div",{style:{display:"inline-flex",background:"#FFCCCB",borderRadius:"5px"},children:(0,k.jsx)("div",{style:{padding:5},children:(0,k.jsxs)(K.B,{children:["Your request for ",a," approval could not be completed. Please"," ",(0,k.jsx)(M.rU,{external:!0,href:"mailto:bcgov.sso@gov.bc.ca",children:"contact the Pathfinder SSO Team"})]})})}):(0,k.jsx)(k.Fragment,{children:m.length>0?m.map(function(e){return(0,k.jsxs)("p",{style:{marginBottom:"5px"},"data-testid":"idp-approved-note",children:["Approved by ",(0,k.jsx)("b",{children:null==e?void 0:e.idirUserDisplayName})," on"," ",(0,k.jsx)("b",{children:new Date(null==e?void 0:e.createdAt).toLocaleString()})]},e.id)}):(0,k.jsx)("p",{children:"This integration has already been approved."})});var P=(n=(0,u.Z)(f().mark(function _callee2(){var e,t;return f().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,S.WN)(TabContent_objectSpread(TabContent_objectSpread({},i),{},(0,U.Z)({},E,!0)),!0);case 2:e=n.sent,t=(0,d.Z)(e,2)[1],l&&!t&&l();case 6:case"end":return n.stop()}},_callee2)})),function(){return n.apply(this,arguments)});return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsxs)(B,{children:[(0,k.jsx)("br",{}),r]}),(0,k.jsx)(C.Z,{id:"".concat(a,"-approval-modal"),openModal:p,handleClose:function(){return v(!1)},content:"Are you sure you want to approve this integration for ".concat(A," production?"),onConfirm:P,icon:j.eHv,title:"".concat(A," Approve")})]})},AdminTabs_BceidTabContent=function(e){var t=e.integration,n=e.onApproved;if(!t)return null;var r=t.status,i=t.bceidApproved;return(0,k.jsx)(AdminTabs_TabContent,{type:"bceid",integration:t,canApproveProd:!i,awaitingTFComplete:"applied"!==r,onApproved:n})},AdminTabs_GithubTabContent=function(e){var t=e.integration,n=e.onApproved;if(!t)return null;var r=t.status,i=t.githubApproved;return(0,k.jsx)(AdminTabs_TabContent,{type:"github",integration:t,canApproveProd:!i,awaitingTFComplete:"applied"!==r,onApproved:n})},AdminTabs_BcServicesCardTabContent=function(e){var t=e.integration,n=e.onApproved;if(!t)return null;var r=t.status,i=t.bcServicesCardApproved;return(0,k.jsx)(AdminTabs_TabContent,{type:"BCServicesCard",integration:t,canApproveProd:!i,awaitingTFComplete:"applied"!==r,onApproved:n})},Q=n(5363),G=E.ZP.div(o||(o=(0,p.Z)(["\n  padding-left: 1rem;\n  padding-right: 1rem;\n"]))),admin_dashboard_AdminTabs=function(e){var t=e.currentUser,n=e.integration,r=e.defaultTabKey,i=e.setActiveKey,a=e.setRows,o=e.activeKey,s=(0,h.useState)("dev"),l=s[0],c=s[1],d=!(null!=n&&n.archived)&&!(null!=n&&n.apiServiceAccount)&&t.isAdmin,u=t.isAdmin;if(!n)return null;var p=n.environments,v=void 0===p?[]:p,f=v.includes("prod"),b=(0,P.Jx)(n)&&f&&(t.isAdmin||(0,w.cN)(t)),m=(0,P.dV)(n)&&f&&(t.isAdmin||(0,w.LS)(t)),j=(0,P.e$)(n)&&f&&(t.isAdmin||(0,w.T0)(t));return(0,k.jsx)(k.Fragment,{children:(0,k.jsxs)(_.mQ,{activeKey:void 0===o?r:o,onChange:function(e){return i(e)},tabBarGutter:30,children:[(0,k.jsx)(_.OK,{tab:"Details",children:(0,k.jsx)(G,{children:(0,k.jsx)(AdminRequestPanel,{currentUser:t,request:n,onUpdate:a})})},"details"),b&&(0,k.jsx)(_.OK,{tab:"BCeID Prod",children:(0,k.jsx)(AdminTabs_BceidTabContent,{integration:n,onApproved:function(){return a()}})},"bceid-prod"),m&&(0,k.jsx)(_.OK,{tab:"GitHub Prod",children:(0,k.jsx)(AdminTabs_GithubTabContent,{integration:n,onApproved:function(){return a()}})},"github-prod"),j&&(0,k.jsx)(_.OK,{tab:"BC Services Card Prod",children:(0,k.jsx)(AdminTabs_BcServicesCardTabContent,{integration:n,onApproved:function(){return a()}})},"bcsc-prod"),u&&(0,k.jsx)(_.OK,{tab:"Events",children:(0,k.jsx)(G,{children:(0,k.jsx)(AdminEventPanel,{requestId:n.id})})},"events"),d&&(0,k.jsx)(_.OK,{tab:"Roles",children:(0,k.jsx)(G,{children:(0,k.jsxs)(_.mQ,{onChange:c,activeKey:l,tabBarGutter:30,destroyInactiveTabPane:!0,children:[(0,k.jsx)("br",{}),v.map(function(e){return(0,k.jsx)(_.OK,{tab:x()(e),children:(0,k.jsx)(Q.Z,{environment:e,integration:n,viewOnly:!0})},e)})]})})},"roles")]})})},V=n(46312),$=n(79858),W=n(14493),Y=E.ZP.div(s||(s=(0,p.Z)(["\n  height: 100%;\n  overflow: auto;\n"]))),admin_dashboard_VerticalLayout=function(e){var t=e.leftPanel,n=e.rightPanel,r=e.showResizable;return e.children,(0,k.jsxs)($.Z,{rules:W.F,children:[void 0===r||r?(0,k.jsx)(V.e,{style:{paddingTop:"2px",borderBottom:"3px solid black"},defaultSize:{width:"100%",height:.45*window.innerHeight},enable:{bottom:!0},handleStyles:{bottom:{bottom:0}},children:(0,k.jsx)(Y,{children:t&&t()})}):t&&t(),(0,k.jsx)("br",{}),n&&n()]})},z=n(10170),J=n(35685),X=n(82500),ee=n(60915),et=n(16530),en=n(69604),er=n(34798),ei=n.n(er),ea=n(34155),eo=[{value:"idir",label:"IDIR"},{value:"bceid",label:"BCeID"},{value:"github",label:"GitHub"},{value:"digitalcredential",label:"Digital Credential"},{value:"bcservicescard",label:"BC Services Card"}],es=[{value:"active",label:"Active"},{value:"archived",label:"Deleted"}],el=[{value:"dev",label:"Dev"},{value:"test",label:"Test"},{value:"prod",label:"Prod"}],ec=[5,10,15,30,50,100];function ActionsHeader(){return(0,k.jsx)("span",{style:{marginLeft:"40%"},children:"Actions"})}var ed=E.ZP.div(l||(l=(0,p.Z)(["\n  .restoration-email-select {\n    * {\n      visibility: inherit;\n    }\n  }\n  label {\n    margin-bottom: 0.5em;\n  }\n  .error-text {\n    margin-top: 0.5em;\n    color: red;\n  }\n"]))),RestoreModalContent=function(e){var t,n,r=e.selectedIntegration,i=e.loadData,a=e.alert,o=e.showModal,s=e.handleCloseModal,l=(0,h.useState)(!1),c=l[0],p=l[1],v=(0,h.useState)(!1),b=v[0],m=v[1],x=(0,h.useState)(""),j=x[0],g=x[1],y=(0,h.useState)(""),A=y[0],w=y[1],E=(t=(0,u.Z)(f().mark(function _callee(){var e,t,n;return f().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return m(!0),i.next=3,(0,z.Um)(String(r.teamId));case 3:e=i.sent,n=(t=(0,d.Z)(e,2))[0],t[1],p(!!n),m(!1);case 9:case"end":return i.stop()}},_callee)})),function(){return t.apply(this,arguments)});(0,h.useEffect)(function(){w(""),g(""),null!=r&&r.usesTeam&&E()},[null==r?void 0:r.id]),(0,h.useEffect)(function(){w("")},[j]);var _=(n=(0,u.Z)(f().mark(function _callee2(){var e,t,n,o,s,l;return f().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(e=!(null!=r&&r.usesTeam&&c),t=!1,!(e&&!j)){u.next=5;break}return w("Please select an email address to restore the integration to."),u.abrupt("return");case 5:if(!(null!=r&&r.apiServiceAccount)){u.next=15;break}return u.next=8,(0,z.NU)(Number(null==r?void 0:r.teamId),null==r?void 0:r.id);case 8:n=u.sent,(o=(0,d.Z)(n,2))[0],t=!!o[1],u.next=22;break;case 15:return u.next=17,(0,S.OS)(null==r?void 0:r.id,j);case 17:s=u.sent,(l=(0,d.Z)(s,2))[0],t=!!l[1];case 22:return t&&a.show({variant:"danger",content:"Failed to restore integration, please try again."}),u.next=25,i();case 25:handleClose();case 26:case"end":return u.stop()}},_callee2)})),function(){return n.apply(this,arguments)}),handleClose=function(){g(""),w("")};if(!r)return null;var P="";return P=b?"Checking if the team exists...":r.usesTeam&&c?"You are about to restore this integration.":r.apiServiceAccount&&!c?"Cannot restore this team account, team does not exist.":(0,k.jsxs)(ed,{children:[(0,k.jsx)("label",{htmlFor:"restoration-email-select",children:"Please validate the requestor who is asking to restore (get one more government employee confirming their role). Please enter new requestor email address. Note this requestor can then assign to a new team as needed."}),(0,k.jsx)(J.Z,{loadOptions:et.c,value:{value:j,label:j},onChange:function(e){return g((null==e?void 0:e.label)||"")},noOptionsMessage:function(){return"Start typing email..."},maxMenuHeight:120,placeholder:"Enter email address",id:"restoration-email-select",className:"restoration-email-select"}),A&&(0,k.jsx)("p",{className:"error-text",children:"Select an email address"})]}),(0,k.jsx)(C.Z,{id:"restore-modal","data-testid":"modal-restore-integration",content:P,onConfirm:_,confirmText:"Restore",title:"Confirm Restoration",showConfirm:!(r.apiServiceAccount&&!c),openModal:o,handleClose:s})},eu=(0,ee.hU)(function(e){var t,n,r,i,a,o,s,l,p=e.session,v=e.alert,m=(0,b.useRouter)(),C=(0,h.useState)(!1),E=C[0],_=C[1],P=(0,h.useState)(!1),T=P[0],Z=P[1],R=(0,h.useState)([]),U=R[0],I=R[1],F=(0,h.useState)(String((null===(s=m.query)||void 0===s?void 0:s.id)||"")),D=F[0],N=F[1],q=(0,h.useState)(0),L=q[0],K=q[1],M=(0,h.useState)(5),B=M[0],H=M[1],Q=(0,h.useState)(1),G=Q[0],V=Q[1],$=(0,h.useState)(Number(null===(l=m.query)||void 0===l?void 0:l.id)||void 0),W=$[0],Y=$[1],J=(0,h.useState)([]),ee=J[0],et=J[1],er=(0,h.useState)([]),ed=er[0],eu=er[1],ep=(0,h.useState)([]),ev=ep[0],ef=ep[1],eh=(0,h.useState)([{value:"active",label:"Active"}]),eb=eh[0],em=eh[1],ex=(0,h.useState)("details"),ej=ex[0],eg=ex[1],eS=(0,h.useState)(!1),ey=eS[0],eC=eS[1],eA=(0,h.useState)(!1),ew=eA[0],eE=eA[1],e_=U.find(function(e){return e.id===W}),eP=(0,h.useState)([{value:ee,multiselect:!0,onChange:et,options:el,label:"Environments"},{value:ev,multiselect:!0,onChange:ef,options:O,label:"Workflow Status"},{value:eb,multiselect:!0,onChange:em,options:es,defaultValue:eb,label:"Archive Status"}]),eT=eP[0],eZ=eP[1],eO=(t=(0,u.Z)(f().mark(function _callee3(){var e,t,n,r,i;return f().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return e=(0,w.UT)(ed,ee),n=(t=(0,d.Z)(e,3))[0],r=t[1],i=t[2],a.abrupt("return",(0,S.zD)({searchField:["id","projectName","clientId"],searchKey:D,order:[["updatedAt","desc"],["status","desc"]],limit:B,page:G,status:ev.map(function(e){return e.value}),archiveStatus:eb.map(function(e){return e.value}),realms:r,environments:i,types:["gold"],devIdps:n}));case 2:case"end":return a.stop()}},_callee3)})),function(){return t.apply(this,arguments)}),ek=(n=(0,u.Z)(f().mark(function _callee4(){var e,t,n;return f().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return _(!0),r.next=3,eO();case 3:e=r.sent,n=(t=(0,d.Z)(e,2))[0],t[1]?Z(!0):n&&(I(n.rows),K(n.count)),_(!1);case 9:case"end":return r.stop()}},_callee4)})),function(){return n.apply(this,arguments)});if((0,h.useEffect)(function(){p.isAdmin||(0,w.HK)(p)?(p.isAdmin&&!eT.find(function(e){return"IDPs"===e.label})&&eZ([].concat((0,c.Z)(eT),[{value:ed,multiselect:!0,onChange:eu,options:eo,label:"IDPs"}])),Y(void 0),ek()):m.push("/my-dashboard")},[D,B,G,ev,eb,ed,ee]),T)return(0,k.jsx)(X.q1,{});var canEdit=function(e){return!e.archived&&["applied"].includes((null==e?void 0:e.status)||"")&&!e.apiServiceAccount},canDelete=function(e){return!0!==e.archived&&!["pr","planned","submitted"].includes((null==e?void 0:e.status)||"")},canRestore=function(e){return!1!==e.archived&&!!["applied"].includes((null==e?void 0:e.status)||"")},eR=(r=(0,u.Z)(f().mark(function _callee5(e){return f().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(!e.id||!canEdit(e))){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,m.push("/request/".concat(e.id,"?status=").concat(e.status));case 4:case"end":return t.stop()}},_callee5)})),function(e){return r.apply(this,arguments)}),eU=(i=(0,u.Z)(f().mark(function _callee6(e){return f().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(!e.id||!canDelete(e))){t.next=2;break}return t.abrupt("return");case 2:Y(e.id),eE(!0);case 4:case"end":return t.stop()}},_callee6)})),function(e){return i.apply(this,arguments)}),eI=(a=(0,u.Z)(f().mark(function _callee7(e){return f().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(!e.id||!canRestore(e))){t.next=2;break}return t.abrupt("return");case 2:Y(e.id),eC(!1),ea.nextTick(function(){eC(!0)});case 5:case"end":return t.stop()}},_callee7)})),function(e){return a.apply(this,arguments)}),eF=(o=(0,u.Z)(f().mark(function _callee8(){var e,t;return f().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(canDelete){n.next=2;break}return n.abrupt("return");case 2:if(!(null!=e_&&e_.apiServiceAccount)){n.next=8;break}return n.next=5,(0,z.yN)(null==e_?void 0:e_.teamId,W);case 5:n.t0=n.sent,n.next=11;break;case 8:return n.next=10,(0,S.Jl)(W);case 10:n.t0=n.sent;case 11:return e=n.t0,(t=(0,d.Z)(e,2))[0],t[1]&&v.show({variant:"danger",content:"Failed to delete the integration, please try again."}),n.next=18,ek();case 18:case"end":return n.stop()}},_callee8)})),function(){return o.apply(this,arguments)}),activateRow=function(e){Y(e.cells[0].value),eg("details")};return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(admin_dashboard_VerticalLayout,{leftPanel:function(){return(0,k.jsx)(g.Z,{searchPlaceholder:"Project ID, Project Name or Client ID",headers:[{accessor:"id",Header:"Request ID"},{accessor:"clientId",Header:"Client ID"},{accessor:"projectName",Header:"Project Name"},{accessor:"status",Header:"Request Status"},{accessor:"archived",Header:"File Status"},{accessor:"actions",Header:(0,k.jsx)(ActionsHeader,{}),disableSortBy:!0}],data:U.map(function(e){return{id:e.id,projectName:e.projectName,status:x()(e.status),archived:e.archived?"Deleted":"Active",environments:e.environments,clientId:e.clientId,actions:p.isAdmin?(0,k.jsxs)(y.c4,{children:[(0,k.jsx)(y.Kk,{icon:j.Mdf,role:"button","aria-label":"events",onClick:function(t){t.stopPropagation(),Y(e.id),eg("events")},title:"Events"}),(0,k.jsx)(y.MO,{}),(0,k.jsx)(y.Kk,{disabled:!canEdit(e),icon:j.Xcf,role:"button","aria-label":"edit",onClick:function(){return eR(e)},title:"Edit"}),(0,k.jsx)(y.MO,{}),(0,k.jsx)(y.Kk,{icon:j.$aW,role:"button","aria-label":"delete",onClick:function(){return eU(e)},disabled:!canDelete(e),activeColor:A.Uo,title:"Delete from Keycloak"}),(0,k.jsx)(y.MO,{}),(0,k.jsx)(y.Kk,{icon:j.pdr,role:"button","aria-label":"restore",onClick:function(){return eI(e)},disabled:!canRestore(e),activeColor:A.Uo,title:"Restore at Keycloak"})]}):ei()}}),activateRow:activateRow,colfilters:eT,showFilters:!0,loading:E,totalColSpan:15,searchColSpan:5,headerAlign:"bottom",headerGutter:[5,0],onPage:V,rowCount:L,searchKey:D,onSearch:function(e){N(e)},onEnter:function(e){N(e)},pageLimits:ec,limit:B,onLimit:function(e){V(1),H(e)},noDataFoundElement:(0,k.jsx)("div",{style:{textAlign:"center"},children:"No clients found."}),pagination:!0})},rightPanel:function(){return e_&&(0,k.jsx)(admin_dashboard_AdminTabs,{currentUser:p,integration:e_,defaultTabKey:"details",setActiveKey:eg,activeKey:ej,setRows:ek})}}),(0,k.jsx)(en.Z,{id:"delete-modal",projectName:null==e_?void 0:e_.projectName,onConfirm:eF,title:"Confirm Deletion",content:"You are about to delete this integration request. This action cannot be undone.",openModal:ew,handleCloseModal:function(){return eE(!1)}}),(0,k.jsx)(RestoreModalContent,{selectedIntegration:e_,loadData:ek,alert:v,showModal:ey,handleCloseModal:function(){return eC(!1)}})]})})},25809:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin-dashboard",function(){return n(35477)}])},35685:function(e,t,n){"use strict";n.d(t,{Z:function(){return v}});var r=n(2717),i=n(67294),a=n(28648),o=n(65342),s=n(28549),l=n(33417),c=n(70292),d=n(30138),u=n(17609),p=["defaultOptions","cacheOptions","loadOptions","options","isLoading","onInputChange","filterOption"];n(73935),n(73469);var v=(0,i.forwardRef)(function(e,t){var n,v,f,h,b,m,x,j,g,S,y,C,A,w,E,_,P,T,Z,O,k,R,U,I,F,D,N,q,L,K,M,B,H,Q,G,V,$,W,Y,z,J,X,ee,et,en,er,ei,ea,eo,es,el,ec=(v=void 0!==(n=e.defaultOptions)&&n,h=void 0!==(f=e.cacheOptions)&&f,b=e.loadOptions,e.options,m=e.isLoading,x=e.onInputChange,j=e.filterOption,S=(g=(0,d.Z)(e,p)).inputValue,y=(0,i.useRef)(void 0),C=(0,i.useRef)(!1),A=(0,i.useState)(Array.isArray(v)?v:void 0),E=(w=(0,c.Z)(A,2))[0],_=w[1],P=(0,i.useState)(void 0!==S?S:""),Z=(T=(0,c.Z)(P,2))[0],O=T[1],k=(0,i.useState)(!0===v),U=(R=(0,c.Z)(k,2))[0],I=R[1],F=(0,i.useState)(void 0),N=(D=(0,c.Z)(F,2))[0],q=D[1],L=(0,i.useState)([]),M=(K=(0,c.Z)(L,2))[0],B=K[1],H=(0,i.useState)(!1),G=(Q=(0,c.Z)(H,2))[0],V=Q[1],$=(0,i.useState)({}),Y=(W=(0,c.Z)($,2))[0],z=W[1],J=(0,i.useState)(void 0),ee=(X=(0,c.Z)(J,2))[0],et=X[1],en=(0,i.useState)(void 0),ei=(er=(0,c.Z)(en,2))[0],ea=er[1],h!==ei&&(z({}),ea(h)),v!==ee&&(_(Array.isArray(v)?v:void 0),et(v)),(0,i.useEffect)(function(){return C.current=!0,function(){C.current=!1}},[]),eo=(0,i.useCallback)(function(e,t){if(!b)return t();var n=b(e,t);n&&"function"==typeof n.then&&n.then(t,function(){return t()})},[b]),(0,i.useEffect)(function(){!0===v&&eo(Z,function(e){C.current&&(_(e||[]),I(!!y.current))})},[]),es=(0,i.useCallback)(function(e,t){var n=(0,u.L)(e,t,x);if(!n){y.current=void 0,O(""),q(""),B([]),I(!1),V(!1);return}if(h&&Y[n])O(n),q(n),B(Y[n]),I(!1),V(!1);else{var r=y.current={};O(n),I(!0),V(!N),eo(n,function(e){C&&r===y.current&&(y.current=void 0,I(!1),q(n),B(e||[]),V(!1),z(e?(0,l.Z)((0,l.Z)({},Y),{},(0,s.Z)({},n,e)):Y))})}},[h,eo,N,Y,x]),el=G?[]:Z&&N?M:E||[],(0,l.Z)((0,l.Z)({},g),{},{options:el,isLoading:U||void 0!==m&&m,onInputChange:es,filterOption:void 0===j?null:j})),ed=(0,o.u)(ec);return i.createElement(a.S,(0,r.Z)({ref:t},ed))})}},function(e){e.O(0,[662,925,936,706,620,479,326,240,226,774,888,179],function(){return e(e.s=25809)}),_N_E=e.O()}]);