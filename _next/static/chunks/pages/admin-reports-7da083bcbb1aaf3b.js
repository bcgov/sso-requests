(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[304],{93626:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return F}});var r,a,s,o,c,i,l=n(50029),u=n(59499),p=n(71383),d=n(87794),h=n.n(d),f=n(67294),x=n(99603),b=n(59417),v=n(85330),g=n(59912),m=n(42894),j=n(21963),w=n(84105),k=new Date,_="".concat(k.getFullYear()).concat(k.getMonth()+1).concat(k.getDate()).concat(k.getHours()).concat(k.getMinutes()),y=(r=(0,l.Z)(h().mark(function e(){var t,n,r;return h().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,j.e.get("reports/all-standard-integrations").then(function(e){return e.data});case 3:t=e.sent,n=w.P6.json_to_sheet(t),r=w.P6.book_new(),w.P6.book_append_sheet(r,n,"All standard integrations"),w.NC(r,"all-standard-integrations-".concat(_,".xlsx")),e.next=14;break;case 10:return e.prev=10,e.t0=e.catch(0),console.log(e.t0),e.abrupt("return",(0,j.z)(e.t0));case 14:case"end":return e.stop()}},e,null,[[0,10]])})),function(){return r.apply(this,arguments)}),P=(a=(0,l.Z)(h().mark(function e(t,n){var r,a,s;return h().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,j.e.get("reports/database-tables",{params:{type:t,orderBy:n}}).then(function(e){return e.data});case 3:r=e.sent,a=w.P6.json_to_sheet(r),s=w.P6.book_new(),w.P6.book_append_sheet(s,a,"All ".concat(t)),w.NC(s,"all-".concat(t.toLowerCase(),"-").concat(_,".xlsx")),e.next=14;break;case 10:return e.prev=10,e.t0=e.catch(0),console.log(e.t0),e.abrupt("return",(0,j.z)(e.t0));case 14:case"end":return e.stop()}},e,null,[[0,10]])})),function(e,t){return a.apply(this,arguments)}),O=(s=(0,l.Z)(h().mark(function e(){var t,n,r;return h().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,j.e.get("reports/all-bceid-approved-requests-and-events").then(function(e){return e.data});case 3:t=e.sent,n=w.P6.json_to_sheet(t),r=w.P6.book_new(),w.P6.book_append_sheet(r,n,"All BCeID Approved Reqs&Events"),w.NC(r,"all-bceid-approved-requests-and-events-".concat(_,".xlsx")),e.next=14;break;case 10:return e.prev=10,e.t0=e.catch(0),console.log(e.t0),e.abrupt("return",(0,j.z)(e.t0));case 14:case"end":return e.stop()}},e,null,[[0,10]])})),function(){return s.apply(this,arguments)}),C=n(71893),Z=n(74379),q=n(76691),E=n(85893);function A(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function D(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?A(Object(n),!0).forEach(function(t){(0,u.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):A(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var N=C.ZP.div(o||(o=(0,p.Z)(["\n  border-bottom: 1px solid #707070;\n  margin-bottom: 20px;\n  padding-bottom: 10px;\n"]))),z=C.ZP.div(c||(c=(0,p.Z)(["\n  display: flex;\n"]))),R=C.ZP.div(i||(i=(0,p.Z)(["\n  padding-top: 5px;\n  margin-left: 20px;\n"]))),T=[{maxWidth:900,marginTop:0,marginLeft:10,marginRight:10,marginUnit:"px",horizontalAlign:"none"},{width:480,marginTop:0,marginLeft:2.5,marginRight:2.5,marginUnit:"rem",horizontalAlign:"none"}],S=[{value:"all-requests",label:"Integrations"},{value:"all-users",label:"Users"},{value:"all-teams",label:"Teams"},{value:"all-events",label:"Events"}],U={"all-requests":"Requests","all-users":"Users","all-teams":"Teams","all-events":"Events"},I={Requests:"id",Users:"id",Teams:"id",Events:"request_id"};function B(e){return""==e.type?(0,E.jsx)(E.Fragment,{}):(0,E.jsx)(q.Kk,{icon:b.q7m,role:"button",onClick:e.handleClick,title:"Download",size:"lg"})}function F(e){e.session;var t,n,r,a=(0,f.useState)(!1),s=a[0],o=a[1],c=(0,f.useState)(""),i=c[0],u=c[1],p=(t=(0,l.Z)(h().mark(function e(){return h().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o(!0),e.next=3,y();case 3:o(!1);case 4:case"end":return e.stop()}},e)})),function(){return t.apply(this,arguments)}),d=(n=(0,l.Z)(h().mark(function e(){return h().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o(!0),e.next=3,O();case 3:o(!1);case 4:case"end":return e.stop()}},e)})),function(){return n.apply(this,arguments)}),j=(r=(0,l.Z)(h().mark(function e(){return h().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o(!0),e.next=3,P(U[i],I[U[i]]);case 3:o(!1);case 4:case"end":return e.stop()}},e)})),function(){return r.apply(this,arguments)});return(0,E.jsxs)(g.Z,{rules:T,children:[(0,E.jsx)("h2",{children:"Reports"}),(0,E.jsx)(N,{children:s?(0,E.jsx)(m.rj,{color:"#000",height:25,width:25,wrapperClass:"d-block",visible:s}):(0,E.jsxs)(E.Fragment,{children:[(0,E.jsxs)(v.zx,{variant:"primary",type:"button",className:"text-center",onClick:p,children:[(0,E.jsx)("span",{children:"All Standard Integrations\xa0"}),(0,E.jsx)(x.G,{icon:b.q7m})]}),(0,E.jsx)("br",{}),(0,E.jsx)("br",{}),(0,E.jsxs)(v.zx,{variant:"primary",type:"button",className:"text-center",onClick:d,children:[(0,E.jsx)("span",{children:"All BCeID Approved Requests And Events\xa0"}),(0,E.jsx)(x.G,{icon:b.q7m})]})]})}),(0,E.jsx)("h2",{children:"Database"}),s?(0,E.jsx)(m.rj,{color:"#000",height:25,width:25,wrapperClass:"d-block",visible:s}):(0,E.jsxs)(z,{children:[(0,E.jsx)(function(){return(0,E.jsx)(Z.ZP,{value:S.filter(function(e){return e.value===i}),options:S,onChange:function(e){return u(e.value)},maxMenuHeight:300,placeholder:"Select table...",styles:{control:function(e){return D(D({},e),{},{width:"250px"})},menu:function(e){return D(D({},e),{},{width:"250px"})}}})},{}),(0,E.jsx)(R,{children:(0,E.jsx)(B,{type:i,handleClick:j})})]})]})}},36484:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin-reports",function(){return n(93626)}])},20067:function(){},72061:function(){}},function(e){e.O(0,[251,693,634,691,774,888,179],function(){return e(e.s=36484)}),_N_E=e.O()}]);